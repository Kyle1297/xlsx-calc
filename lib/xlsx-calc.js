!function(r,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t=e();for(var n in t)("object"==typeof exports?exports:r)[n]=t[n]}}(this,(function(){return function(r){var e={};function t(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return r[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=r,t.c=e,t.d=function(r,e,n){t.o(r,e)||Object.defineProperty(r,e,{enumerable:!0,get:n})},t.r=function(r){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},t.t=function(r,e){if(1&e&&(r=t(r)),8&e)return r;if(4&e&&"object"==typeof r&&r&&r.__esModule)return r;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:r}),2&e&&"string"!=typeof r)for(var o in r)t.d(n,o,function(e){return r[e]}.bind(null,o));return n},t.n=function(r){var e=r&&r.__esModule?function(){return r.default}:function(){return r};return t.d(e,"a",e),e},t.o=function(r,e){return Object.prototype.hasOwnProperty.call(r,e)},t.p="",t(t.s=9)}([function(r,e,t){"use strict";r.exports=function(r){this.setValue=function(e){r=e},this.calc=function(){return r}}},function(r,e,t){"use strict";r.exports=function(r){for(var e,t=r+1,n="",o=10;t>0&&o--;)e=(t-1)%26,n=String.fromCharCode(e+65)+n,t=(t-e-1)/26;return n}},function(r,e,t){"use strict";r.exports=function(r){for(var e=0,t=r.replace(/[0-9]+$/,""),n=t.length;n--;)e+=Math.pow(26,t.length-n-1)*(t.charCodeAt(n)-64);return e-1}},function(r,e,t){"use strict";const n=t(2),o=t(1),i=t(4);r.exports=function(r,e){this.name="Range",this.calc=function(){const{min_row:r,max_row:t,min_col:n,max_col:i,sheet:a,sheet_name:f}=this.parseRange();for(var s=[],u=r;u<=t;u++){var l=[];s.push(l);for(var c=n;c<=i;c++){var h=o(c)+u,p=f+"!"+h,g=e.formula_ref[p];if(g){if("new"===g.status)e.exec_formula(g);else if("working"===g.status){if(g.cell.f.includes(e.name))throw new Error("Circular ref");e.exec_formula(g)}"e"===a[h].t?l.push(a[h]):l.push(a[h].v)}else a[h]?"e"===a[h].t?l.push(a[h]):l.push(a[h].v):l.push(null)}}return s},this.parseRange=function(){var t,o,a;if(-1!=r.indexOf("!")){var f=r.split("!");o=i(f[0]),t=f[1]}else o=e.sheet_name,t=r;a=e.wb.Sheets[o];var s=t.split(":"),u=parseInt(s[0].replace(/^[A-Z]+/,""),10)||0,l=s[1].replace(/^[A-Z]+/,"");return""===l&&a["!ref"]&&(l=a["!ref"].split(":")[1].replace(/^[A-Z]+/,"")),{sheet:a,sheet_name:o,range_expression:t,range_full_expression:o+"!"+t,min_row:u,max_row:parseInt(""==l?"500000":l,10),min_col:n(s[0]),max_col:n(s[1])}}}},function(r,e,t){"use strict";r.exports=function(r){var e=r.match(/^'(.*)'$/);return e?e[1]:r}},function(r,e,t){const n=t(0),o=t(6),i=t(13),a=t(3);let f,s;function u(r,e){if(!e.wb.Workbook||!e.wb.Workbook.Names)return null;if(s!==e.wb)return s=e.wb,f=null,u(r,e);if(f)return f[r];const t=Object.values(e.wb.Workbook.Names);return 0!==t.length?(f={},t.forEach(({Name:r,Ref:e})=>{r.includes(".")||(f[r]=e)}),u(r,e)):void 0}r.exports=function r(e,t){if(!isNaN(e))return new n(+e);if("TRUE"===e)return new n(1);if("string"!=typeof e)return e;if((e=e.trim().replace(/\$/g,"")).match(/^[A-Z]+[0-9]+:[A-Z]+[0-9]+$/))return new a(e,t);if(e.match(/^[^!]+![A-Z]+[0-9]+:[A-Z]+[0-9]+$/))return new a(e,t);if(e.match(/^[A-Z]+:[A-Z]+$/))return new a(e,t);if(e.match(/^[^!]+![A-Z]+:[A-Z]+$/))return new a(e,t);if(e.match(/^[A-Z]+[0-9]+$/))return new o(e,t);if(e.match(/^[^!]+![A-Z]+[0-9]+$/))return new o(e,t);if(e.match(/%$/)){var f=r(e.substr(0,e.length-1),t);return new i(()=>f.calc()/100)}return u(e,t)?r(u(e,t),t):e}},function(r,e,t){"use strict";const n=t(4);r.exports=function(r,e){var t=this;this.name="RefValue",this.str_expression=r,this.formula=e,t.parseRef=function(){var t,o,i,a;if(-1!=r.indexOf("!")){var f=r.split("!");o=n(f[0]),t=e.wb.Sheets[o],i=f[1]}else t=e.sheet,o=e.sheet_name,i=r;if(!t)throw Error("Sheet "+o+" not found.");return a=o+"!"+i,{sheet:t,sheet_name:o,cell_name:i,row_num:parseInt(i.replace(/[^0-9]/g,"")),cell_full_name:a}},this.calc=function(){var r=t.parseRef(),n=r.sheet,o=r.cell_name,i=r.cell_full_name,a=n[o];if(!a)return null;var f=e.formula_ref[i];if(!f){if("e"===a.t)throw console.log("ref is an error with no formula",o),new Error(a.w);return a.v}if("new"===f.status){if(e.exec_formula(f),"e"===a.t)throw new Error(a.w);return a.v}if("working"===f.status){if(a.f.includes(e.name))throw new Error("Circular ref");return e.exec_formula(f),this.calc()}if("done"===f.status){if("e"===a.t)throw new Error(a.w);return a.v}}}},function(r,e){const t=new Error("#NULL!"),n=new Error("#DIV/0!"),o=new Error("#VALUE!"),i=new Error("#REF!"),a=new Error("#NAME?"),f=new Error("#NUM!"),s=new Error("#N/A"),u=new Error("#ERROR!"),l=new Error("#GETTING_DATA"),c=new Error("#CALC!"),h={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#CALC!":0};r.exports={nil:t,div0:n,value:o,ref:i,name:a,num:f,na:s,error:u,data:l,calc:c,getErrorValueByMessage:function(r){return h[r]}}},function(r,e,t){"use strict";r.exports=function(r,e){let t={},n=[];for(let o in r.Sheets){let i=r.Sheets[o];for(let a in i)if(i[a]&&i[a].f){let f=t[o+"!"+a]={formula_ref:t,wb:r,sheet:i,sheet_name:o,cell:i[a],name:a,status:"new",exec_formula:e};n.push(f)}}return n}},function(r,e,t){"use strict";const n=t(1),o=t(2),i=t(10),a=t(8),f=t(19);var s=function(r,e){for(var t=a(r,i),n=t.length-1;n>=0;n--)try{i(t[n])}catch(r){if(!e||!e.continue_after_error)throw r;e.log_error&&console.log("error executing formula","sheet",t[n].sheet_name,"cell",t[n].name,r)}};s.calculator=function(r){return new f(r,i)},s.set_fx=i.set_fx,s.exec_fx=i.exec_fx,s.col_str_2_int=o,s.int_2_col_str=n,s.import_functions=i.import_functions,s.import_raw_functions=i.import_raw_functions,s.xlsx_Fx=i.xlsx_Fx,s.localizeFunctions=i.localizeFunctions,s.XLSX_CALC=s,r.exports=s},function(r,e,t){"use strict";const n=t(11);let o={},i={};function a(r,e){for(var t in r)i[t]=r[t]}function f(r,e){var t=(e=e||{}).prefix||"";for(var n in r){var i=r[n];"function"==typeof i?!e.override&&o[t+n]||(o[t+n]=i):"object"==typeof i&&f(i,s(e,{prefix:n+"."}))}}function s(r,e){var t=JSON.parse(JSON.stringify(r));for(var n in e)t[n]=e[n];return t}function u(r){return n(r,{xlsx_Fx:o,xlsx_raw_Fx:i})}function l(r){u(r).update_cell_value()}f(t(16)),a(t(18)),l.set_fx=function(r,e){o[r]=e},l.exec_fx=function(r,e){return o[r].apply(this,e)},l.localizeFunctions=function(r){for(let e in r){let t=r[e];o[t]&&(o[e]=o[t]),i[t]&&(i[e]=i[t])}},l.import_functions=f,l.import_raw_functions=a,l.build_expression=u,l.xlsx_Fx=o,r.exports=l},function(r,e,t){const n=t(12),o=t(0),i=t(14),a=t(15),f={"*":"multiply","+":"plus","-":"minus","/":"divide","^":"power","&":"concat","<":"lt",">":"gt","=":"eq"};r.exports=function(r,e){r.status="working";var t,s=e.xlsx_Fx||{},u=e.xlsx_raw_Fx||{},l=r.cell.f;"="==l[0]&&(l=l.substr(1));var c=t=new n(r),h="",p=!1,g=[{exp:c}];function w(r){'"'===r?(c.push(new o(h)),p=!0,h="",m=v):h+=r}function A(r){"'"===r&&(m=v),h+=r}function v(e){var t,o;'"'===e?(m=w,h=""):"'"===e?(m=A,h="'"):"("===e?function(){var e,t=h.trim(),o=s[t],f=u[t];if(f)o=new a(f,r);else if(o)o=new i(o,r);else if(t)throw new Error('"'+r.sheet_name+'"!'+r.name+": Function "+h+" not found");e=new n(r),g.push({exp:e,special:o}),c=e,h=""}():")"===e?(o=g.pop(),(c=o.exp).push(h),t=c,h="",c=g[g.length-1].exp,o.special?(o.special.push(t),c.push(o.special)):c.push(t)):f[e]?function(r){p||c.push(h),p=!1,c.push(r),h=""}(e):","===e&&g[g.length-1].special?(p=!1,g[g.length-1].exp.push(h),g[g.length-1].special.push(g[g.length-1].exp),g[g.length-1].exp=c=new n(r),h=""):" "!==e&&(h+=e)}for(var m=v,y=0;y<l.length;y++)m(l[y]);return t.push(h),t}},function(r,e,t){"use strict";const n=t(0),o=t(3),i=t(5);var a=0;r.exports=function(r){var e,t=this;function f(r){return null==r||""===r}function s(r){if("function"!=typeof r.calc)throw new Error("Undefined "+r)}function u(){return+t.formula.name.replace(/[^0-9]/g,"")}function l(r,e,t,o){for(var i=0;i<e.length;i++)if(e[i]===r)try{if(0===i&&"+"===r){s(e[i+1]);let r=e[i+1].calc();e.splice(i,2,new n(r))}else{s(e[i-1]),s(e[i+1]);let r=e[i-1].calc(o),a=e[i+1].calc(o);Array.isArray(r)&&(!o&&r.length>=u()?r=r[u()-1][0]:1!==r.length||Array.isArray(r[0])?1===r.length&&Array.isArray(r[0]&&1===r[0].length)&&Array.isArray(r[0][0])&&(r[0]=r[0][0]):r=r[0]),Array.isArray(a)&&(!o&&a.length>=u()?a=a[u()-1][0]:1!==a.length||Array.isArray(a[0])?1===a.length&&Array.isArray(a[0])&&a[0].length>1&&Array.isArray(a[0][0])&&(a=a[0]):a=a[0]);let f=[];if(Array.isArray(r)&&Array.isArray(a))for(let e=0;e<r.length;e++){f.push([]);for(let n=0;n<r[e].length;n++)f[e].push(t(r[e][n],a[e][n]))}else if(Array.isArray(r))for(let e=0;e<r.length;e++){f.push([]);for(let n=0;n<r[e].length;n++)f[e].push(t(r[e][n],a))}else if(Array.isArray(a))for(let e=0;e<a.length;e++){f.push([]);for(let n=0;n<a[e].length;n++)f[e].push(t(r,a[e][n]))}else f=t(r,a);e.splice(i-1,3,new n(f)),i--}}catch(r){throw r}}t.id=++a,t.args=[],t.name="Expression",t.update_cell_value=function(){try{if(Array.isArray(t.args)&&1===t.args.length&&t.args[0]instanceof o)throw Error("#VALUE!");r.cell.v=t.calc(),"string"==typeof r.cell.v?r.cell.t="s":"number"==typeof r.cell.v&&(r.cell.t="n")}catch(t){var e={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43};if(void 0===e[t.message])throw t;r.cell.t="e",r.cell.w=t.message,r.cell.v=e[t.message]}finally{r.status="done"}},t.formula=r,t.calc=function(r=!1){let e=t.args.concat();if(l("^",e,(function(r,e){return Math.pow(+r,+e)}),r),function(r){for(var e=r.length;e--;)if("-"===r[e]){s(r[e+1]);var t=r[e+1].calc();if(e>0&&"string"!=typeof r[e-1]){if(r.splice(e,1,"+"),t instanceof Date){t=Date.parse(t),s(r[e-1]);var o=r[e-1].calc();o instanceof Date&&(o=Date.parse(o)/864e5,t/=864e5,r.splice(e-1,1,new n(o)))}r.splice(e+1,1,new n(-t))}else{if("string"==typeof t)throw new Error("#VALUE!");r.splice(e,2,new n(-t))}}}(e),l("/",e,(function(r,e){if(0==e)throw Error("#DIV/0!");return+r/+e}),r),l("*",e,(function(r,e){return""===r||""===e?new Error("#VALUE!"):+r*+e}),r),l("+",e,(function(r,e){return""===r||""===e?new Error("#VALUE!"):(r instanceof Date&&"number"==typeof e&&(e*=864e5),+r+ +e)}),r),l("&",e,(function(r,e){return""+r+e}),r),l("<",e,(function(r,e){return r<e}),r),l(">",e,(function(r,e){return r>e}),r),l(">=",e,(function(r,e){return r>=e}),r),l("<=",e,(function(r,e){return r<=e}),r),l("<>",e,(function(r,e){return r instanceof Date&&e instanceof Date?r.getTime()!==e.getTime():(!f(r)||!f(e))&&r!==e}),r),l("=",e,(function(r,e){return r instanceof Date&&e instanceof Date?r.getTime()===e.getTime():!(!f(r)||!f(e))||(null==r&&0===e||0===r&&null==e||("string"==typeof r&&"string"==typeof e&&r.toLowerCase()===e.toLowerCase()||r===e))}),r),1==e.length)return"function"!=typeof e[0].calc?e[0]:e[0].calc()},t.push=function(n){if(n){var o=i(n,r);"="===o&&(">"==e||"<"==e)||"<"==e&&">"===o?t.args[t.args.length-1]+=o:t.args.push(o),e=o}}}},function(r,e,t){"use strict";r.exports=function(r){this.calc=function(){return r()}}},function(r,e,t){"use strict";r.exports=function(r){var e=this;e.name="UserFn",e.args=[],e.row=function(){const r=e.args.map(r=>r.args[0]);if(r.length>1)return new Error("#N/A");if(0===r.length||null==r[0])return parseInt(e.args[0].formula.name.replace(/[^0-9]/g,""));if("RefValue"!==r[0].name&&"Range"!==r[0].name)return new Error("#VALUE!");if("RefValue"===r[0].name){const{row_num:e}=r[0].parseRef();return e}if("Range"===r[0].name){const{min_row:e,max_row:t}=r[0].parseRange(),n=[];for(let r=e;r<t+1;r++)n.push([r]);return n}return new Error("#N/A")},e.calc=function(){var t,n={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43};try{t="ROW"===r.name?e.row():r.apply(e,e.args.map(e=>e.calc("FILTER"===r.name))),("FILTER"===r.name||"ROW"===r.name)&&Array.isArray(t)&&t.length>0&&Array.isArray(t[0])&&t[0].length>0&&(t=t[0][0])}catch(e){if("is_blank"===r.name&&void 0!==n[e.message])t=0;else{if("iserror"!==r.name||void 0===n[e.message])throw e;t=!0}}return t},e.push=function(r){e.args.push(r)}}},function(r,e,t){"use strict";r.exports=function(r,e){var t=this;t.name="UserRawFn",t.args=[],t.calc=function(){try{return r.apply(t,t.args)}catch(r){throw r}},t.push=function(r){t.args.push(r)}}},function(r,e,t){"use strict";const n=t(17),o=t(7);let i={FLOOR:Math.floor,"_xlfn.FLOOR.MATH":Math.floor,"FLOOR.MATH":Math.floor,ABS:Math.abs,SQRT:Math.sqrt,VLOOKUP:function(r,e,t,n=!0){for(var o=null,i=0;i<e.length;i++)if(e[i][0]<r)o=e[i][t-1];else if(e[i][0]==r)return e[i][t-1];if(n&&o)return o;throw Error("#N/A")},MAX:function(){for(var r=null,e=arguments.length;e--;){var t=arguments[e];if(Array.isArray(t))for(var n=t,o=n.length;o--;){var i=n[o];if(Array.isArray(i))for(var a=i.length;a--;)(null==r||null!=i[a]&&r<i[a])&&(r=i[a]);else(null==r||null!=i&&r<i)&&(r=i)}else!isNaN(t)&&(null==r||null!=t&&r<t)&&(r=t)}return r},SUM:m,MIN:function(){for(var r=null,e=arguments.length;e--;){var t=arguments[e];if(Array.isArray(t))for(var n=t,o=n.length;o--;){var i=n[o];if(Array.isArray(i))for(var a=i.length;a--;)(null==r||null!=i[a]&&r>i[a])&&(r=i[a]);else(null==r||null!=i&&r>i)&&(r=i)}else!isNaN(t)&&(null==r||null!=t&&r>t)&&(r=t)}return r},CONCATENATE:function(){for(var r="",e=0;e<arguments.length;e++){var t=arguments[e];null!=t&&(r+=t)}return r},PMT:function(r,e,t,n,o){if(o=o||0,n=n||0,0!=r){var i=Math.pow(1+r,e);return-r*(n+i*t)/((-1+i)*(1+r*o))}if(0!=e)return-(n+t)/e;return 0},COUNTA:v,IRR:function(r,e){var t=-2,n=1,o=0;do{for(var i=(t+n)/2,a=0,f=0;f<r.length;f++){var s=r[f];a+=s[0]/Math.pow(1+i,f)}a>0?(t===n&&(n+=Math.abs(i)),t=i):n=i,o++}while(Math.abs(a)>1e-6&&o<1e5);return i},"NORM.INV":A,"_xlfn.NORM.INV":A,STDEV:function(){var r=p(arguments);function e(r){return r.reduce((function(r,e){return r+e}))/r.length}var t=e(r),n=r.map((function(r){return(r-t)*(r-t)}));return Math.sqrt(n.reduce((function(r,e){return r+e}))/(r.length-1))},AVERAGE:w,EXP:function(r){return Math.pow(Math.E,r)},LN:Math.log,"_xlfn.VAR.P":g,"VAR.P":g,"_xlfn.COVARIANCE.P":h,"COVARIANCE.P":h,TRIM:function(r){return(""+r).trim()},LEN:function(r){return(""+r).length},ISBLANK:c,HLOOKUP:function(r,e,t,n){if(void 0===r||c(r))throw Error("#N/A");t=t||0;let o,i,a=e[0];if("string"==typeof r){for(i=r.toLowerCase(),o=0;o<a.length;o++)if(n&&a[o]===i||-1!==a[o].toLowerCase().indexOf(i))return t<e.length+1?e[t-1][o]:e[0][o]}else for(i=r,o=0;o<a.length;o++)if(n&&a[o]===i||a[o]===i)return t<e.length+1?e[t-1][o]:e[0][o];throw Error("#N/A")},INDEX:function(r,e,t){if(e<=r.length){var n=r[e-1];if(!Array.isArray(n))return r[e];if(!t)return n;if(t<=n.length)return n[t-1]}throw Error("#REF!")},MATCH:function(r,e,t){Array.isArray(e)&&1===e.length&&Array.isArray(e[0])&&(e=e[0]);if(!r&&!e)throw Error("#N/A");2===arguments.length&&(t=1);if(!(e instanceof Array))throw Error("#N/A");if(0===t)return"string"==typeof r?s(e,r):u(e,r);if(1===t)return f(e,r);if(-1===t)return l(e,r);throw Error("#N/A")},SUMPRODUCT:function(){var r=function(r){return void 0===r||""===r||null===r||isNaN(r)?0:parseFloat(r)},e=function(r){for(var e=function(r){return r.length},t=function(r){return r[0].length},n=e(r[0]),o=t(r[0]),i=1;i<r.length;i++)if(e(r[i])!==n||t(r[i])!==o)return!1;return!0};if(!arguments||0===arguments.length)throw Error("#VALUE!");if(!e(arguments))throw Error("#VALUE!");for(var t=0;t<arguments.length;t++){var n=arguments[t];if(Array.isArray(n))for(var o=0;o<n.length;o++){var i=n[o];if(Array.isArray(i))for(var a=0;a<i.length;a++){var f;if((f=i[a])&&"object"==typeof f&&"e"===f.t)throw Error(f.w)}else if((f=i)&&"object"==typeof f&&"e"===f.t)throw Error(f.w)}else if((f=n)&&"object"==typeof f&&"e"===f.t)throw Error(f.w)}var s,u,l,c=arguments.length+1,h=0;for(t=0;t<arguments[0].length;t++)if(arguments[0][t]instanceof Array)for(o=0;o<arguments[0][t].length;o++){for(s=1,a=1;a<c;a++)l=r(arguments[a-1][t][o]),s*=l;h+=s}else{for(s=1,a=1;a<c;a++)u=r(arguments[a-1][t]),s*=u;h+=s}return h},ISNUMBER:function(r){return!isNaN(r)},TODAY:function(){var r=new Date;return r.setHours(0,0,0,0),r},ISERROR:function(){return!1},TIME:function(r,e,t){return 1e3*(60*(60*r+e)+t)/864e5},DAY:function(r){if(!r.getDate)throw Error("#VALUE!");var e=r.getDate();if(isNaN(e))throw Error("#VALUE!");return e},MONTH:function(r){if(!r.getMonth)throw Error("#VALUE!");var e=r.getMonth();if(isNaN(e))throw Error("#VALUE!");return e+1},YEAR:function(r){if(!r.getFullYear)throw Error("#VALUE!");var e=r.getFullYear();if(isNaN(e))throw Error("#VALUE!");return e},RIGHT:function(r,e){if(e=void 0===e?1:parseFloat(e),isNaN(e))throw Error("#VALUE!");r=null==r?"":""+r;return r.substring(r.length-e)},LEFT:function(r,e){if(e=void 0===e?1:parseFloat(e),isNaN(e))throw Error("#VALUE!");r=null==r?"":""+r;return r.substring(0,e)},IFS:function(){for(var r=0;r+1<arguments.length;r+=2){var e=arguments[r],t=arguments[r+1];if(e)return t}throw Error("#N/A")},ROUND:function(r,e){if(0===arguments.length)throw new Error("Err:511");if(1===arguments.length)return Math.round(r);let t=Math.pow(10,e);return Math.round(t*r)/t},CORREL:function(r,e){if(r=p(r),e=p(e),r.length!==e.length)return"N/D";for(var t=1/(r.length-1),n=m.apply(this,r)/r.length,o=m.apply(this,e)/e.length,i=0,a=0,f=0,s=0;s<r.length;s++)i+=(r[s]-n)*(e[s]-o),a+=Math.pow(r[s],2),f+=Math.pow(e[s],2);return a=Math.sqrt(a/t),f=Math.sqrt(f/t),i/(t*a*f)},SUMIF:function(){let r=arguments[1],e=0;return[].slice.call(arguments)[0][0].forEach((t,n)=>{null!==t&&(t=t.toString()).replace(/\'/g,"")===r&&(isNaN([].slice.call(arguments)[2][0][n])||(e+=[].slice.call(arguments)[2][0][n]))}),e},CHOOSE:function(r){return arguments[r]},SUBSTITUTE:function(r,e,t,n){if(n<=0)throw Error("#VALUE!");if(!r||!e||!t&&""!==t)return r;if(void 0===n)return r.replace(new RegExp(e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1"),"g"),t);for(var o=0,i=0;r.indexOf(e,o)>0;)if(o=r.indexOf(e,o+1),++i===n)return r.substring(0,o)+t+r.substring(o+e.length)},CEILING:function(r,e){return Math.ceil(r/e)*e},FILTER:(a=function(r,e,t){if(!r||!e)return o.na;if(!(r instanceof Array))return o.na;if(!(e instanceof Array))return o.na;if(0===r.length)return o.na;if(0===e.length)return o.na;for(let e=0;e<r.length;e++){if(!(r[e]instanceof Array))return o.na;if(0===r[e].length)return o.na;if(r[e].length!==r[0].length)return o.na}for(let r=0;r<e.length;r++){if(!(e[r]instanceof Array))return o.na;if(0===e[r].length)return o.na;if(e[r].length!==e[0].length)return o.na}const i=r[0].length,a=r.length,f=e[0].length,s=e.length;if(i!==f&&a!==s)return o.na;if(a>1&&i>1&&(i===f&&1!==s||a===s&&1!==f))return o.na;if(a>1&&1===i&&(1!==f||1!==s&&s!==a))return o.na;const u=[];for(let t=0;t<a;t++){const o=[];for(let f=0;f<i;f++){const s=y(e,t,f)||y(e,0,f)||y(e,t,0),u=n.parseBool(s);if(!0===u)o.push(r[t][f]);else if(u instanceof Error)return n.addEmptyValuesToArray([[u]],i,a)}o.length>0&&u.push(o)}return 0===u.length?null!=t?n.addEmptyValuesToArray([[t]],i,a):n.addEmptyValuesToArray([[o.calc]],i,a):n.addEmptyValuesToArray(u,i,a)},function(){const r=a.apply(this,arguments);if(r instanceof Error)throw r;return r})};var a;function f(r,e){for(var t,n,o=0;o<r.length;o++){if(r[o]===e)return o+1;r[o]<e&&(n?r[o]>n&&(t=o+1,n=r[o]):(t=o+1,n=r[o]))}if(!t)throw Error("#N/A");return t}function s(r,e){for(var t=0;t<r.length;t++)if(e=e.replace(/\?/g,"."),Array.isArray(r[t])){if(1===r[t].length&&"string"==typeof r[t][0]&&r[t][0].toLowerCase()===e.toLowerCase())return t+1}else if("string"==typeof r[t]&&r[t].toLowerCase()===e.toLowerCase())return t+1;throw Error("#N/A")}function u(r,e){for(var t=0;t<r.length;t++)if(Array.isArray(r[t])){if(1===r[t].length&&r[t][0]===e)return t+1}else if(r[t]===e)return t+1;throw Error("#N/A")}function l(r,e){for(var t,n,o=0;o<r.length;o++)if(Array.isArray(r[o])&&r[o].length>0){if(r[o][0]===e)return o+1;r[o][0]>e&&(n?r[o][0]<n&&(t=o+1,n=r[o][0]):(t=o+1,n=r[o][0]))}else{if(r[o]===e)return o+1;r[o]>e&&(n?r[o]<n&&(t=o+1,n=r[o]):(t=o+1,n=r[o]))}if(!t)throw Error("#N/A");return t}function c(r){return!r}function h(r,e){if(r=p(r),e=p(e),r.length!=e.length)return"N/D";for(var t=1/r.length,n=m.apply(this,r)/r.length,o=m.apply(this,e)/e.length,i=0,a=0;a<r.length;a++)i+=(r[a]-n)*(e[a]-o);return i*t}function p(r){for(var e=[],t=0;t<r.length;t++){var n=r[t];if(Array.isArray(n)){for(var o=n,i=o.length;i--;)if("number"==typeof o[i])e.push(o[i]);else if(Array.isArray(o[i]))for(var a=o[i].length;a--;)"number"==typeof o[i][a]&&e.push(o[i][a])}else"number"==typeof n&&e.push(n)}return e}function g(){for(var r=w.apply(this,arguments),e=0,t=0,n=0;n<arguments.length;n++){var o=arguments[n];if(Array.isArray(o))for(var i=o,a=i.length;a--;)for(var f=i[a].length;f--;)null!==i[a][f]&&void 0!==i[a][f]&&(e+=Math.pow(i[a][f]-r,2),t++);else e+=Math.pow(o-r,2),t++}return e/t}function w(){var r=v.apply(this,arguments);if(0==r)throw Error("#DIV/0!");return m.apply(this,arguments)/r}function A(r,e,t){if(r<0||r>1)throw"The probality p must be bigger than 0 and smaller than 1";if(t<0)throw"The standard deviation sigma must be positive";return 0==r?-1/0:1==r?1/0:0==t?e:(n=r-.5,Math.abs(n)<=.425?i=n*(((((((2509.0809287301227*(o=.180625-n*n)+33430.57558358813)*o+67265.7709270087)*o+45921.95393154987)*o+13731.69376550946)*o+1971.5909503065513)*o+133.14166789178438)*o+3.3871328727963665)/(((((((5226.495278852854*o+28729.085735721943)*o+39307.89580009271)*o+21213.794301586597)*o+5394.196021424751)*o+687.1870074920579)*o+42.31333070160091)*o+1):(o=n>0?1-r:r,i=(o=Math.sqrt(-Math.log(o)))<=5?(((((((.0007745450142783414*(o+=-1.6)+.022723844989269184)*o+.2417807251774506)*o+1.2704582524523684)*o+3.6478483247632045)*o+5.769497221460691)*o+4.630337846156546)*o+1.4234371107496835)/(((((((1.0507500716444169e-9*o+.0005475938084995345)*o+.015198666563616457)*o+.14810397642748008)*o+.6897673349851)*o+1.6763848301838038)*o+2.053191626637759)*o+1):(((((((2.0103343992922881e-7*(o+=-5)+27115555687434876e-21)*o+.0012426609473880784)*o+.026532189526576124)*o+.29656057182850487)*o+1.7848265399172913)*o+5.463784911164114)*o+6.657904643501103)/(((((((20442631033899397e-31*o+1.421511758316446e-7)*o+18463183175100548e-21)*o+.0007868691311456133)*o+.014875361290850615)*o+.1369298809227358)*o+.599832206555888)*o+1),n<0&&(i=-i)),e+t*i);var n,o,i}function v(){for(var r=0,e=arguments.length;e--;){var t=arguments[e];if(Array.isArray(t))for(var n=t,o=n.length;o--;)for(var i=n[o].length;i--;)null!==n[o][i]&&void 0!==n[o][i]&&r++;else null!=t&&r++}return r}function m(){for(var r=0,e=arguments.length;e--;){var t=arguments[e];if(Array.isArray(t))for(var n=t,o=n.length;o--;)for(var i=n[o].length;i--;)isNaN(n[o][i])||(r+=+n[o][i]);else r+=+t}return r}function y(r,e,t){if(r[e])return!1===r[e][t]?"FALSE":r[e][t]}r.exports=i},function(r,e,t){const n=t(7);r.exports={addEmptyValuesToArray:function(r,e,t){if(!r||!e||!t)return r;if(e<0||t<0)return r;if(!Array.isArray(r)||!r.length)return r;for(let e=0;e<r.length;e++)if(!(r[e]instanceof Array))return r;for(let t=0;t<r.length;t++)if(r[t].length<e)for(let n=r[t].length;n<e;n++)r[t].push("");if(r.length<t)for(let n=r.length;n<t;n++){r.push([]);for(let t=0;t<e;t++)r[n].push("")}return r},parseBool:function(r){if("boolean"==typeof r)return r;if(r instanceof Error)return r;if("number"==typeof r)return 0!==r;if("string"==typeof r){const e=r.toUpperCase();if("TRUE"===e)return!0;if("FALSE"===e)return!1}return r instanceof Date&&!isNaN(r)||n.value}}},function(r,e,t){"use strict";const n=t(1),o=t(2),i=t(0),a=t(3),f=t(6);r.exports={OFFSET:function(r,e,t,s,u){if(s=(s||new i(1)).calc(),u=(u||new i(1)).calc(),1===r.args.length&&"RefValue"===r.args[0].name){var l=r.args[0],c=l.parseRef(),h=o(c.cell_name)+t.calc(),p=n(h),g=+c.cell_name.replace(/^[A-Z]+/g,"")+e.calc(),w=c.sheet_name+"!"+p+g;if(1===s&&1===u)return new f(w,l.formula).calc();var A=n(h+u-1);return new a(w+":"+(A+(g+s-1)),l.formula).calc()}}}},function(r,e,t){"use strict";const n=t(0),o=t(5),i=t(8);r.exports=class{constructor(r,e){this.workbook=r,this.expressions=[],this.exec_formula=e,this.variables={},this.formulas=i(r,e);for(let r=this.formulas.length-1;r>=0;r--){let t=e.build_expression(this.formulas[r]);this.expressions.push(t)}this.calcNames()}setVar(r,e){let t=this.variables[r];t?t.setValue(e):this.expressions.forEach(t=>{this.setVarOfExpression(t,r,e)})}getVars(){let r={};for(let e in this.variables)r[e]=this.variables[e].calc();return r}calcNames(){this.workbook&&this.workbook.Workbook&&this.workbook.Workbook.Names&&this.workbook.Workbook.Names.forEach(r=>{let e=this.getRef(r.Ref);this.variables[r.Name]=e,this.expressions.forEach(e=>{this.setVarOfExpression(e,r.Name)})})}getRef(r){if(!this.formulas.length)throw new Error("No formula found.");let e={formula_ref:this.formulas[0].formula_ref,wb:this.workbook,exec_formula:this.exec_formula};return o(r,e)}setVarOfExpression(r,e,t){for(let o=0;o<r.args.length;o++){let i=r.args[o];i===e?r.args[o]=this.variables[e]||(this.variables[e]=new n(t)):"object"!=typeof i||"Expression"!==i.name&&"UserFn"!==i.name||this.setVarOfExpression(i,e,t)}}execute(){this.expressions.forEach(r=>{r.update_cell_value()})}}}])}));
//# sourceMappingURL=xlsx-calc.js.map